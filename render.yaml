services:
  - type: web
    name: aimailbox
    env: docker
    plan: starter
    region: oregon
    branch: main
    dockerfilePath: Dockerfile
    buildCommand: mvn -B -DskipTests package
    startCommand: java -jar /app/app.jar --server.port=${PORT:-8080}
    healthCheckPath: /auth/status
    healthCheckIntervalSeconds: 10
    envVars:
      - key: GOOGLE_CLIENT_ID
      - key: GOOGLE_CLIENT_SECRET
      - key: GOOGLE_REDIRECT_URI
      - key: JWT_SECRET
      - key: SPRING_DATASOURCE_URL
      - key: SPRING_DATASOURCE_USERNAME
      - key: SPRING_DATASOURCE_PASSWORD
      - key: CORS_ALLOWED_ORIGINS
      - key: JWT_REFRESH_EXPIRATION_DAYS
    autoDeploy: true

